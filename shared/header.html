<!-- file: shared/header.html -->

<div class="announcement-wrapper">
  <div class="announcement-text" id="announcement-marquee"></div>
</div>

<nav class="navbar">
  <a href="index.html">
    <img class="logo" src="IMG/001 Miru Coffee Logo.png" alt="Miru Coffee Logo">
  </a>
  <ul>
    <li id="li-plans"><a href="plans.html">Plans</a></li>
    <li id="li-beans"><a href="beans.html">Beans</a></li>
    <li id="li-about"><a href="about.html">About</a></li>
    <li id="li-subscribe"><a href="subscribe.html">My Subscription</a></li>
    <li id="li-login"><a href="account.html">Login</a></li>
    <li id="li-account"><a href="account.html">Account</a></li>
    <li id="li-logout"><button id="btn-logout" class="link-button">Logout</button></li>
  </ul>
</nav>

<script type="module">
  import { auth } from "../js/firebase-init.js";
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  const liPlans     = document.getElementById("li-plans");
  const liBeans     = document.getElementById("li-beans");
  const liAbout     = document.getElementById("li-about");
  const liSubscribe = document.getElementById("li-subscribe");
  const liLogin     = document.getElementById("li-login");
  const liAccount   = document.getElementById("li-account");
  const liLogout    = document.getElementById("li-logout");
  const btnLogout   = document.getElementById("btn-logout");

  // 初始隱藏動態項目
  liLogin.style.display     = "none";
  liAccount.style.display   = "none";
  liLogout.style.display    = "none";
  liSubscribe.style.display = "none";

  // 根據登入狀態切換顯示
  onAuthStateChanged(auth, user => {
    if (user && user.emailVerified) {
      liLogin.style.display     = "none";
      liAccount.style.display   = "inline-block";
      liLogout.style.display    = "inline-block";
      liSubscribe.style.display = "inline-block";
    } else {
      liLogin.style.display     = "inline-block";
      liAccount.style.display   = "none";
      liLogout.style.display    = "none";
      liSubscribe.style.display = "none";
    }
    // Plans / Beans / About 固定顯示
    liPlans.style.display =
    liBeans.style.display =
    liAbout.style.display = "inline-block";
  });

  // 登出按鈕行為
  btnLogout.addEventListener("click", () => auth.signOut());
</script>
